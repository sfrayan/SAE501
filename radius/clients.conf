# ============================================================================
# SAE501 - Configuration des clients RADIUS
# Définit les routeurs et périphériques autorisés à accéder au serveur RADIUS
# ============================================================================

# ⚠️⚠️⚠️ AVERTISSEMENT SÉCURITÉ CRITIQUE ⚠️⚠️⚠️
#
# LES SECRETS PAR DÉFAUT DANS CE FICHIER DOIVENT ÊTRE CHANGÉS AVANT PRODUCTION!
#
# Secrets à changer:
# - testing123 (client localhost)
# - MR100_RADIUS_SECRET_CHANGE_ME (routeur 192.168.1.1)
#
# Générer un secret fort:
#   openssl rand -base64 32
#
# Après modification, redémarrer FreeRADIUS:
#   sudo systemctl restart freeradius
#
# Stocker les secrets de manière sécurisée:
#   /opt/sae501/secrets/radius.env (permissions 640)
#
# ⚠️ Ne JAMAIS commiter les vrais secrets dans Git!
# ============================================================================

# Localhost (tests uniquement - NE PAS utiliser en production distante)
client localhost {
    ipaddr = 127.0.0.1
    secret = testing123
    shortname = localhost
    nastype = other
}

# ============================================================================
# Site Pilote - Salle de sport principale
# ============================================================================

# Routeur TL-MR100 principal
client 192.168.1.1 {
    ipaddr = 192.168.1.1
    
    # ⚠️ CHANGER CE SECRET AVANT PRODUCTION!
    # Générer: openssl rand -base64 32
    # Configurer le même secret sur le routeur TL-MR100
    secret = "MR100_RADIUS_SECRET_CHANGE_ME"
    
    shortname = TL-MR100-Pilot
    nastype = other
    
    # Configuration avancée
    response_window = 20
    max_connections = 16
    lifetime = 0
    idle_timeout = 30
    
    # Logging
    # Toutes les requêtes de ce client sont enregistrées
}

# ============================================================================
# Sites secondaires (exemples pour déploiement futur)
# ============================================================================

# Site 2 - Salle de sport Paris Nord
# client 203.0.113.1 {
#     ipaddr = 203.0.113.1
#     secret = "SITE2_RADIUS_SECRET_CHANGE_ME"
#     shortname = TL-MR100-Site2
#     nastype = other
# }

# Site 3 - Salle de sport Paris Est
# client 203.0.113.2 {
#     ipaddr = 203.0.113.2
#     secret = "SITE3_RADIUS_SECRET_CHANGE_ME"
#     shortname = TL-MR100-Site3
#     nastype = other
# }

# ============================================================================
# INSTRUCTIONS DE CONFIGURATION
# ============================================================================
#
# 1. MODIFIER LES SECRETS RADIUS (⚠️ OBLIGATOIRE AVANT PRODUCTION)
#    a) Générer une clé aléatoire forte:
#       openssl rand -base64 32
#    
#    b) Remplacer "MR100_RADIUS_SECRET_CHANGE_ME" par le secret généré
#    
#    c) Configurer le MÊME secret sur le routeur TL-MR100:
#       - Accéder à l'interface web du routeur
#       - Section RADIUS Server
#       - Copier exactement le même secret
#    
#    d) Stocker le secret de manière sécurisée:
#       echo "MR100_SECRET='votre_secret'" >> /opt/sae501/secrets/radius.env
#       chmod 640 /opt/sae501/secrets/radius.env
#    
#    e) Redémarrer FreeRADIUS:
#       sudo systemctl restart freeradius
#
# 2. AJOUTER DE NOUVEAUX CLIENTS
#    - Dé-commenter les sections secondaires
#    - Remplir ipaddr avec l'IP du routeur
#    - Générer un secret UNIQUE par client (openssl rand -base64 32)
#    - Relancer FreeRADIUS: sudo systemctl restart freeradius
#
# 3. VÉRIFIER LA CONFIGURATION
#    - Test local: radtest testuser testpass localhost 1812 testing123
#    - Test distant: radtest testuser testpass VOTRE_IP 1812 VOTRE_SECRET
#    - Logs: sudo tail -f /var/log/freeradius/radius.log
#
# 4. SÉCURITÉ (CHECK-LIST AVANT PRODUCTION)
#    [ ] Secret testing123 changé pour localhost
#    [ ] Secret MR100_RADIUS_SECRET_CHANGE_ME changé
#    [ ] Secrets uniques pour chaque site
#    [ ] Secrets stockés dans /opt/sae501/secrets/radius.env (chmod 640)
#    [ ] .gitignore activé (fichier .gitignore, pas gitignore)
#    [ ] Aucun secret commit dans Git (git log --all --full-history -- "*secret*")
#    [ ] FreeRADIUS redémarré après modifications
#    [ ] Tests d'authentification réussis depuis chaque site
#
# 5. AUDIT DE SÉCURITÉ
#    - Vérifier régulièrement: sudo grep "testing123" /etc/freeradius/3.0/clients.conf
#    - Si testing123 trouvé en production: VULNÉRABILITÉ CRITIQUE!
#    - Vérifier permissions: ls -la /etc/freeradius/3.0/clients.conf
#    - Doit être: -rw-r----- 1 freerad freerad (640)
#
